---
layout: post
title: "More Interesting Sparkler Patterns"
---
A few years ago I had the idea of combining a sparkler with a drill and thought the results were pretty good. However, there is one obvious limitation, you can only make circles. I therefore wanted to build something that could create more interesting patterns while still being driven by a drill.

<img src="/assets/circle.jpeg" alt="My image" width="400" style="display:block; margin: 0 auto;">


### The Pattern
Starting with the type of pattern to create, one of the more obvious designs was a double pendulum type mechanism which would definitely meet the criteria of not being a circle. This would also be relatively easy to build, you basically just need two pieces of wood vaguely attached to each other, but this option also had a few major drawbacks; (1) having a sparkler randomly flailing about didn’t feel like a very elegant solution and (2) the previously mentioned flailing would probably result in some very unbalanced forces going through the drill.

Instead I decided an <a href="https://en.wikipedia.org/wiki/Epicycloid" target="_blank" rel="noopener"> epicycloid / hypocycloid pattern </a> would be better. These are the curves generated when you roll a circle around the outside / inside of another circle and trace a point attached to the rotating circle. More specifically the epicycloid / hypocycloid are the special cases where the point sits on the circumference of the rotating circle; if you allow the point to be any distance from the centre then it's known as an epitrochoid / hypotrochoid. The most well known of these is probably the epicycloid case where the two circles have the same radius resulting in a cardioid shape being traced out. 

At this point in the project I got distracted making an animation to show different epicycloid patterns but it was interesting to see how you can get pretty reasonable approximations of regular polygons by combining only two rotating circles.

<!-- <iframe
  src="{{ '/assets/cycloid.html' | relative_url }}"
  width="100%"
  height="780"
  style="border:none; overflow:hidden;">
</iframe> -->

<div style="
  max-width: 900px;
  margin: 0 auto;
">
  <div style="
    position: relative;
    width: 100%;
    padding-top: 98%; /* controls aspect ratio */
  ">
    <iframe
      src="{{ '/assets/cycloid.html' | relative_url }}"
      style="
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border: none;
      ">
    </iframe>
  </div>
</div>

### Planetary Gears + some maths

Back to the problem of actually creating these patterns in the real world. Luckily I’m a few thousand years late to solving this for the first time and the planetary gearset has already been <a href="https://en.wikipedia.org/wiki/Antikythera_mechanism" target="_blank" rel="noopener"> invented</a>. These gearsets consist of a sun gear, planet gears (held together with a planet carrier) and a ring gear. By holding one of the components stationary you can get three different gear ratios but for the purposes of this project the configurations I care about are:

(1) Fixed ring gear with the sun gear or planet carrier driven. This equates to a circle rotating around the inside of another circle giving a hypocycloid pattern.

(2) Fixed sun gear with the ring gear or planet carrier driven. This equates to a circle rotating around the outside of another circle giving an epicycloid pattern.

The sparkler is then attached to one of the planet gears and acts as the point being traced out.

In either of these configurations it might not be immediately obvious why the planet carrier itself would move when the sun gear or ring gear are driven; can’t the planet gears just rotate in place? A good intuitive explanation for this is to consider the fact that wherever two sets of gear teeth mesh they must be moving at the same speed, otherwise they would clash and the whole system would bind up. Taking configuration (1) with a driven sun gear:

- The sun gear is rotating so the planet gears also rotate, exactly what you’d expect

- However, this rotation now means that the planet gears have a different speed to the fixed ring gear. In order to solve this problem the planet carrier also has to start rotating but in the opposite direction to the planet gears. The sum of these two rotations cancel out giving the planet gear teeth an effective speed of zero, the same as the ring gear

Using this fact lets you then calculate the gear ratio between the input sun gear and the planet carrier.
<br>
<br>

![Planetary gearbox](/assets/gearbox.svg)
<br>
<br>

### Designing the Gearbox

Compared to a typical gearbox the main difference for my design was keeping the face completely open so that the sparkler could fully rotate while extending beyond the outside diameter of the gears. I also wanted to be able to drive the gearbox from either the sun gear or the planet carrier. This led to a split housing design with flanges on the planet carrier and ring gear to constrain them axially. The casing, planet carrier and sun gear then have concentric shafts which can all rotate independently of each other with an additional driver to run the planet carrier.
<br>
<br>
<br>
**CAD**

<div style="
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;
  max-width: 750px;
  margin: 0 auto;
">
  <img src="/assets/cad_1.png" alt="Image 1" style="width: 100%; height: auto;">
  <img src="/assets/cad_2.png" alt="Image 2" style="width: 100%; height: auto;">
</div>

<br>
**Actual**

<div style="
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;
  max-width: 750px;
  margin: 0 auto;
">
  <img src="/assets/IMG_9988.png" alt="Image 1" style="width: 100%; height: auto;">
  <img src="/assets/IMG_9968.png" alt="Image 2" style="width: 100%; height: auto;">
</div>

### Running the Gearbox

So onto the actual gearbox and how it performed. After a couple of test runs where one of the bearings managed to escape (these were subsequently glued in place rather than trusting a press-fit approach) and the planet carrier friction welded itself to the casing (mostly solved with vaseline) it was running about as well as I could have hoped for.

With the sparkler attached it was also producing some undeniably non-circle shapes. The ratio I ended up using between the ring gear and planet gear (k, hypocycloid mode) was 2.8 which was more based on the first values I found that met the
<a href="https://qtcgears.com/tools/catalogs/PDF_Q420/Tech.pdf" target="_blank" rel="noopener"> conditions for planetary gearboxes</a> rather than aiming for a specific pattern. As the ratio is a non-integer the full pattern doesn’t form a short loop, however the length of persistence of vision means you don’t see the entire pattern but instead see something closer to a rotating version of k = 3.

<div style="
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;
  max-width: 750px;
  margin: 0 auto;
">
  <img src="/assets/three_1.jpeg" alt="Image 1" style="width: 100%; height: auto;">
  <img src="/assets/three_2.jpeg" alt="Image 2" style="width: 100%; height: auto;">
  <img src="/assets/three_3.jpeg" alt="Image 3" style="width: 100%; height: auto;">
  <img src="/assets/three_4.jpeg" alt="Image 4" style="width: 100%; height: auto;">
</div>
<br>
<br>
Decreasing the shutter speed lets you then see more of the pattern.
<div style="
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;
  max-width: 750px;
  margin: 0 auto;
">
  <img src="/assets/full_1.jpeg" alt="Image 1" style="width: 100%; height: auto;">
  <img src="/assets/full_2.jpeg" alt="Image 2" style="width: 100%; height: auto;">
  <img src="/assets/full_3.jpeg" alt="Image 3" style="width: 100%; height: auto;">
  <img src="/assets/full_4.jpeg" alt="Image 4" style="width: 100%; height: auto;">
</div>


### Future Designs

Unfortunately I wasn’t able to get the gearbox to run in the epicycloid mode. The main issue is that the sun gear needs to be stationary relative to the casing but this is also the inner most shaft and so any connection between the sun gear and casing would collide with the planet carrier / driver or the sparkler. I ran out of time to solve this problem for the v1 design and was unrealistically hoping that the epicycloid mode would just happen to require the lowest torque to run when the ring gear was unconstrained. This wasn’t the case. 

This is the main issue I’d like to fix in a v2 design and have a couple of solutions in mind. One would be to drive the ring gear directly and then fix the sun gear to the back of the casing as the planet carrier driver would no longer be required. Another potentially simpler solution would be to make an insert for the sun gear which increased its inertia enough so that the epicycloid was the lowest torque configuration. Not certain that solution will work but should at least be interesting to try.
